********
# Домашнее задание 18
### 18.1 "Аська" (мессенджер с хранением недоставленных сообщений на сервере)  
Логика работы:  
Для общения с клиентами сервер использует пул потоков. Обмен происходит через Object streams.  
Клиент и сервер обмениваются объектами `ChatMessage` (интерфейс), `ChatCommand` (перечисление) и наследниками `RuntimeException`. Если сервер получил что-то не ожидаемое, то создается исключение (не бросается), которое отправляется клиенту.  
Интерфейс `ChatMessage` позволяет в дальнейшем добавить реализацию сообщения с вложениями.
Хранение и чтение сообщений (интерфейс `MessageDao`) реализовано in memory - на конкурентной мапе, значениями которой являются `CopyOnWriteArrayList`, чтобы гарантировать happens-before между отправкой сообщения пользователю и получением сообщений этим пользователем (и очистки сообщений на сервере). Архитектура позволяет без переделывания реализовать любой другой способ хранения сообщений.  
Особенность реализации клиента: в конструктор клиента можно передать `InputStream` и `OutputStream`, что позволяет писать сообщения в чат не с клавиатуры, а с любого `InputStream`, и аналогично с выводом полученных с сервера сообщений. Имеется также упрощенный конструктор, который использует `System.in` и `System.out`. 

### 18.2 Клиент-серверная гадалка на сокетах
Сервер использует пул потоков. Обмен происходит строками через BufferedReader/PrintStream. Возможные ответы сервера описаны в перечислении.  

Научился использовать Object Stream в обе стороны, использовать пулы потоков для ограничения нагрузки на сервер. Столкнулся с проблемой, когда при создании на сокете `ObjectInputStream` нужно, чтобы `ObjectOutputStream` уже был создан на другой стороне, и можно было бы прочитать заголовок потока. 